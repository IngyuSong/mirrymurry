<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.codepresso3.mirrymurry.mapper.StoreMapper">

    <select id="bookMngList" resultType="com.codepresso3.mirrymurry.vo.BookMng">
        SELECT book_member_id, email, user_name, phone_number, book_id, DATE_FORMAT(book_time, '%Y-%m-%d') AS bookDate
        FROM book
        JOIN menu ON menu_id = book_menu_id
        LEFT JOIN member ON book_member_id = member_id
        WHERE menu_store_id = #{store_id} AND DATE_FORMAT(book_time, '%Y-%m-%d') = #{bookDate}
    </select>

    <delete id="bookCancel">
        DELETE FROM book WHERE book_id = #{book_id}
    </delete>

    <select id="menuList" resultType="com.codepresso3.mirrymurry.vo.Menu">
        SELECT menu_id, price, menu_name, menu_info, menu_store_id
        FROM menu
        JOIN store ON store_id = menu_store_id
        WHERE store_id = #{store_id}
    </select>

    <insert id="addMenu">
        INSERT INTO menu(price, menu_name, menu_info, menu_store_id)
        VALUES (#{menu.price}, #{menu.menu_name}, #{menu.menu_info}, #{menu.menu_store_id} )
    </insert>

    <select id="getMenu" resultType="com.codepresso3.mirrymurry.vo.Menu">
        SELECT menu_id, price, menu_name, menu_info, menu_store_id
        FROM menu
        WHERE menu_id = #{menu_id}
    </select>

    <update id="updateMenu">
        UPDATE menu
        SET price=#{menu.price}, menu_name=#{menu.menu_name}, menu_info=#{menu.menu_info}
        WHERE menu_id = #{menu.menu_id}
    </update>

</mapper>